<canvas id="pongCanvas" width="300" height="200"></canvas>
<script src="https://cdn.socket.io/4.5.0/socket.io.min.js"></script>
<script>
  const canvas = document.getElementById('pongCanvas');
  const ctx = canvas.getContext('2d');

  const socket = io('https://simple-pong-server.glitch.me', {
    transports: ['websocket'],
  });

  socket.on('connect', () => console.log('âœ… Connected to server'));
  socket.on('disconnect', () => console.log('âŒ Disconnected'));
  socket.on('connect_error', (err) => console.error('âš ï¸ Connection Error:', err));

  const game = {
    player1: { y: 100, score: 0 },
    player2: { y: 100, score: 0 },
    ball: { x: 150, y: 100, dx: 2, dy: 2 },
    isPlayer1: false
  };

  socket.on('assignPlayer', (playerNum) => {
    game.isPlayer1 = (playerNum === 1);
    document.title = game.isPlayer1 ? 'Player 1' : 'Player 2';
  });

  socket.on('gameState', (state) => {
    Object.assign(game, state);
  });

  canvas.addEventListener('mousemove', (e) => {
    const rect = canvas.getBoundingClientRect();
    const y = e.clientY - rect.top;
    socket.emit('paddleMove', y);
  });

  function draw() {
    ctx.fillStyle = 'black';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    ctx.fillStyle = 'white';
    ctx.fillRect(10, game.player1.y - 30, 10, 60);
    ctx.fillRect(280, game.player2.y - 30, 10, 60);

    ctx.beginPath();
    ctx.arc(game.ball.x, game.ball.y, 5, 0, Math.PI * 2);
    ctx.fill();

    ctx.font = '20px Arial';
    ctx.fillText(game.player1.score, 100, 30);
    ctx.fillText(game.player2.score, 200, 30);

    requestAnimationFrame(draw);
  }

  draw();

  // Optional: simulate fake data for testing when server is down
  /*
  setInterval(() => {
    game.ball.x += game.ball.dx;
    game.ball.y += game.ball.dy;

    if (game.ball.y < 0 || game.ball.y > canvas.height) game.ball.dy *= -1;
    if (game.ball.x < 0 || game.ball.x > canvas.width) game.ball.dx *= -1;

    game.player1.y = game.ball.y;
    game.player2.y = canvas.height - game.ball.y;
  }, 1000 / 60);
  */
</script>

</script>
<!--ðŸ”¥ Day 28: WebSocket Multiplayer Pong
ðŸ“Œ Hook: "Multiplayer Pong with WebSockets - play against viewers! ðŸ“ #WebSockets #GameDev"-->

